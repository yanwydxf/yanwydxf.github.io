<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> ArkWeb 适配 · yanwydxf Blog</title><meta name="description" content="ArkWeb 适配 - yanwydxf"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/logo.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://yanwydxf.github.io/atom.xml" title="yanwydxf Blog"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="yanwydxf Blog" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/logo.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">首页</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">目录</a></li><li class="nav-list-item"><a href="/portfolio/" target="_self" class="nav-list-link">作品</a></li><li class="nav-list-item"><a href="https://bento.me/yanwydxf" target="_blank" class="nav-list-link">关于</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">ArkWeb 适配</h1><div class="post-info">2026年1月16日</div><div class="post-content"><h3 id="ArkWeb-介绍"><a href="#ArkWeb-介绍" class="headerlink" title="ArkWeb 介绍"></a>ArkWeb 介绍</h3><p>Web 组件用于在应用程序中显示 Web 页面内容，为开发者提供页面加载、页面交互、页面调试等能力。可以用于实现移动端的混合式开发（Hybrid App）：</p>
<ul>
<li>页面加载：Web 组件提供基础的前端页面加载的能力，包括加载网络页面、本地页面、html 格式文本数据。</li>
<li>页面交互：Web 组件提供丰富的页面交互的方式，包括：设置前端页面深色模式，新窗口中加载页面，位置权限管理，Cookie 管理，应用侧使用前端页面JavaScript 等能力。</li>
<li>页面调试：Web 组件支持使用 Devtools 工具调试前端页面。</li>
</ul>
<h4 id="ArkWeb-API"><a href="#ArkWeb-API" class="headerlink" title="ArkWeb API"></a>ArkWeb API</h4><ul>
<li><a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-basic-components-web">Web 组件</a>：提供具有网页显示能力的一种组件。</li>
<li><a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-webview">Webview</a>：提供 web 控制能力的相关接口。</li>
</ul>
<h4 id="Web-组件的生命周期"><a href="#Web-组件的生命周期" class="headerlink" title="Web 组件的生命周期"></a>Web 组件的生命周期</h4><img src="/images/arkuibase2.png" height="400px" >

<ul>
<li><code>onControllerAttached</code> 事件：当 <code>Controller</code> 成功绑定到 Web 组件时触发该回调。</li>
<li><code>onLoadIntercept</code> 事件：当 <code>Web</code> 组件加载 <code>url</code> 之前触发该回调，用于判断是否阻止此次访问。默认允许加载。</li>
<li><code>onInterceptRequest</code> 事件：当 <code>Web</code> 组件加载 <code>url</code> 之前触发该回调，用于拦截 <code>url</code> 并返回响应数据。</li>
<li><code>onPageBegin</code> 事件：网页开始加载时触发该回调。</li>
<li><code>onProgressChange</code> 事件：告知开发者当前页面加载的进度。</li>
<li><code>onPageEnd</code> 事件：网页加载完成时触发该回调。</li>
<li><code>onPageVisible</code> 事件：当 HTTP 响应的主体开始加载，新页面即将可见时触发该回调，且只在主 frame 触发。</li>
<li><code>onRenderExited</code> 事件：应用渲染进程异常退出时触发该回调, 可以在此回调中进行系统资源的释放、数据的保存等操作。</li>
</ul>
<h3 id="ArkWeb-高频场景1：页面加载、显示及导航"><a href="#ArkWeb-高频场景1：页面加载、显示及导航" class="headerlink" title="ArkWeb 高频场景1：页面加载、显示及导航"></a>ArkWeb 高频场景1：页面加载、显示及导航</h3><ul>
<li>加载网络页面：开发者可以在 Web 组件创建时，指定默认加载的网络页面 。在默认页面加载完成后，如果开发者需要变更此 Web 组件显示的网络页面，可以通过调用 <code>loadUrl()</code> 接口加载指定的网页。</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; webview &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkWeb&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BusinessError</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.BasicServicesKit&#x27;</span>;</span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">WebComponent</span> &#123;</span><br><span class="line">    <span class="attr">webviewController</span>: webview.<span class="property">WebviewController</span> = <span class="keyword">new</span> webview.<span class="title class_">WebviewController</span>();</span><br><span class="line">    <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title class_">Column</span>() &#123;</span><br><span class="line">            <span class="title class_">Button</span>(<span class="string">&#x27;loadUrl&#x27;</span>).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">// 点击按钮时，通过loadUrl，跳转到www.example1.com</span></span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">webviewController</span>.<span class="title function_">loadUrl</span>(<span class="string">&#x27;www.example1.com&#x27;</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">                    ...</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="comment">// 组件创建时，加载www.example.com</span></span><br><span class="line">            <span class="title class_">Web</span>(&#123; <span class="attr">src</span>: <span class="string">&#x27;www.example.com&#x27;</span>, <span class="attr">controller</span>: <span class="variable language_">this</span>.<span class="property">webviewController</span>&#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>加载本地页面：将本地页面文件放在应用的 <code>rawfile</code> 目录下，开发者可以在 Web 组件创建的时候指定默认加载的本地页面 ，并且加载完成后可通过调用 <code>loadUrl()</code> 接口变更当前 Web 组件的页面。</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; webview &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkWeb&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BusinessError</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.BasicServicesKit&#x27;</span>;</span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">WebComponent</span> &#123;</span><br><span class="line">    <span class="attr">webviewController</span>: webview.<span class="property">WebviewController</span> = <span class="keyword">new</span> webview.<span class="title class_">WebviewController</span>();</span><br><span class="line">    <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title class_">Column</span>() &#123;</span><br><span class="line">            <span class="title class_">Button</span>(<span class="string">&#x27;loadUrl&#x27;</span>).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="comment">// 点击按钮时，通过loadUrl，跳转到local1.html</span></span><br><span class="line">                    <span class="variable language_">this</span>.<span class="property">webviewController</span>.<span class="title function_">loadUrl</span>($rawfile(<span class="string">&quot;local1.html&quot;</span>));</span><br><span class="line">                &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">                     ...</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="comment">// 组件创建时，通过$rawfile加载本地文件local.html</span></span><br><span class="line">            <span class="title class_">Web</span>(&#123; <span class="attr">src</span>: $rawfile(<span class="string">&quot;local.html&quot;</span>), <span class="attr">controller</span>: <span class="variable language_">this</span>.<span class="property">webviewController</span> &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>加载 HTML 格式数据:Web 组件可以通过 <code>loadData()</code> 接口实现加载HTML 格式的文本数据。当开发者不需要加载整个页面，只需要显示一<br>些页面片段时，可通过此功能来快速加载页面。</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">WebComponent</span> &#123;</span><br><span class="line">    <span class="attr">controller</span>: webview.<span class="property">WebviewController</span> = <span class="keyword">new</span> webview.<span class="title class_">WebviewController</span>();</span><br><span class="line">    <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title class_">Column</span>() &#123;</span><br><span class="line">        <span class="title class_">Button</span>(<span class="string">&#x27;loadData&#x27;</span>).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">// 点击按钮时，通过loadData，加载HTML格式的文本数据</span></span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">controller</span>.<span class="title function_">loadData</span>(</span><br><span class="line">                <span class="string">&quot;&lt;html&gt;&lt;body bgcolor=\&quot;white\&quot;&gt;Source:&lt;pre&gt;source&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;text/html&quot;</span>,</span><br><span class="line">                <span class="string">&quot;UTF-8&quot;</span></span><br><span class="line">                );</span><br><span class="line">            &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">                 …</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// 组件创建时，加载www.example.com</span></span><br><span class="line">        <span class="title class_">Web</span>(&#123; <span class="attr">src</span>: <span class="string">&#x27;www.example.com&#x27;</span>, <span class="attr">controller</span>: <span class="variable language_">this</span>.<span class="property">controller</span> &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>历史记录导航:在前端页面点击网页中的链接时，Web组件默认会自动打开并加载目标网址。当前端页面替换为新的加载链接时，会自动记录已经访问的网页地址。可以通过 <code>forward()</code> 和 <code>backward()</code> 接口向前&#x2F;向后浏览上一个&#x2F;下一个历史记录。</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; webview &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkWeb&#x27;</span>;</span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">WebComponent</span> &#123;</span><br><span class="line">    <span class="attr">webviewController</span>: webview.<span class="property">WebviewController</span> = <span class="keyword">new</span> webview.<span class="title class_">WebviewController</span>();</span><br><span class="line">    <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title class_">Column</span>() &#123;</span><br><span class="line">        <span class="title class_">Button</span>(<span class="string">&#x27;Backward&#x27;</span>).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">webviewController</span>.<span class="title function_">accessBackward</span>()) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">webviewController</span>.<span class="title function_">backward</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="title class_">Web</span>(&#123; <span class="attr">src</span>: <span class="string">&#x27;https://www.example.com/cn/&#x27;</span>, <span class="attr">controller</span>: <span class="variable language_">this</span>.<span class="property">webviewController</span>&#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>页面跳转:当点击网页中的链接需要跳转到应用内其他页面时，可以通过使用 Web 组件的 <code>onLoadIntercept()</code> 接口来实现。</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">struct <span class="title class_">WebComponent</span> &#123;</span><br><span class="line">    <span class="attr">webviewController</span>: webview.<span class="property">WebviewController</span></span><br><span class="line">    = <span class="keyword">new</span> webview.<span class="title class_">WebviewController</span>();</span><br><span class="line">    <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title class_">Column</span>() &#123;</span><br><span class="line">        <span class="title class_">Web</span>(&#123; <span class="attr">src</span>: $rawfile(<span class="string">&#x27;route.html&#x27;</span>), <span class="attr">controller</span>: <span class="variable language_">this</span>.<span class="property">webviewController</span> &#125;).<span class="title function_">onLoadIntercept</span>(<span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (event) &#123;</span><br><span class="line">                    <span class="keyword">let</span> <span class="attr">url</span>: <span class="built_in">string</span> = event.<span class="property">data</span>.<span class="title function_">toString</span>();</span><br><span class="line">                    <span class="keyword">if</span> (url.<span class="title function_">indexOf</span>(<span class="string">&#x27;native://&#x27;</span>) === <span class="number">0</span>) &#123;</span><br><span class="line">                        <span class="comment">// 跳转其他界面</span></span><br><span class="line">                        router.<span class="title function_">pushUrl</span>(&#123; <span class="attr">url</span>:url.<span class="title function_">substring</span>(<span class="number">9</span>) &#125;)</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>跨应用跳转:Web 组件可以实现点击前端页面超链接跳转到其他应用。</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">WebComponent</span> &#123;</span><br><span class="line">    <span class="attr">webviewController</span>: webview.<span class="property">WebviewController</span> = <span class="keyword">new</span> webview.<span class="title class_">WebviewController</span>();</span><br><span class="line">    <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title class_">Column</span>() &#123;</span><br><span class="line">        <span class="title class_">Web</span>(&#123; <span class="attr">src</span>: $rawfile(<span class="string">&#x27;call.html&#x27;</span>), <span class="attr">controller</span>: <span class="variable language_">this</span>.<span class="property">webviewController</span>&#125;).<span class="title function_">onLoadIntercept</span>(<span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (event) &#123;</span><br><span class="line">                <span class="keyword">let</span> <span class="attr">url</span>: <span class="built_in">string</span> = event.<span class="property">data</span>.<span class="title function_">toString</span>();</span><br><span class="line">                <span class="comment">// 判断链接是否为拨号链接</span></span><br><span class="line">                <span class="keyword">if</span> (url.<span class="title function_">indexOf</span>(<span class="string">&#x27;tel://&#x27;</span>) === <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="comment">// 跳转拨号界面</span></span><br><span class="line">                    call.<span class="title function_">makeCall</span>(url.<span class="title function_">substring</span>(<span class="number">6</span>), <span class="function">(<span class="params">err</span>) =&gt;</span> &#123; ... &#125;);</span><br><span class="line">                     <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                 &#125;</span><br><span class="line">             &#125;</span><br><span class="line">             <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;)</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;!--前端页面 call.<span class="property">html</span> 代码--&gt;</span><br><span class="line">&lt;!-- call.<span class="property">html</span> --&gt;</span><br><span class="line">&lt;!<span class="variable constant_">DOCTYPE</span> html&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;tel://xxx xxxx xxx&quot;</span>&gt;</span>拨打电话<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure></div></article></div></main><footer><div class="paginator"><a href="/2026/01/16/arkuibase/" class="next">下一篇</a></div><div class="copyright"><p>© 2026 <a href="https://yanwydxf.github.io">yanwydxf</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>